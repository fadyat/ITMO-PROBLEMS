ПРАКТИЧЕСКАЯ РАБОТА №1

# Основные инструментальные средства управления Windows Server

**Цель работы:** получить представление и практические навыки работы с основными инструментальными средствами управления Windows Server на примере управления локальными учетными записями и параметрами сетевых интерфейсов.

**Необходимо:**

- Установленная на компьютере среда виртуализации **ORACLE Virtual Box**
- Образы виртуальных жестких дисков операционных систем **Windows Server 2012/2016.**

**Краткие теоретические сведения:**

ОС Windows Server содержит в себе разнообразные средства управления. Для разовых и непериодических действий подходят средства GUI:

- элементы Панели управления,
- стандартные графические консоли Microsoft System Console,
- сборные графические консоли на основе MMC (Microsoft Management Console),
- утилита ServerManager.exe.

Для оркестрации и пакетного выполнения заданий используются:

- утилиты командной строки и скрипты (BAT/CMD),
- командлеты PowerShell искрипты PowerShell. Это средство считается основным.

Элементы Панели управления (например **sysdm.cpl**  или **firewall.cpl** ) и стандартные графические консоли (например **fsmgmt.msc, compmgmt.msc** ) могут быть вызваны через GUI прямо из командной строки.

Сборные графические консоли на основе MMC создаются с помощью утилиты **mmc.exe**. С ее помощью можно собрать в одной консоли стандартные графические консоли, скрипты и внешние программы. Причем консоли можно запускать для управления не только локальным, но и удаленным компьютером.

Утилиты командной строки - утилиты с текстовым вводом-выводом. Для работы с ними используется командный интерпретатор cmd.exe. Утилиты могут вызываться в командных файлах (BAT\CMD). В Windows текстовый файл является скрипом, если имеет расширение .bat или .cmd .

Современным консольным средством является PowerShell - расширяемое средство автоматизации от Microsoft с открытым исходным кодом, состоящее из оболочки с интерфейсом командной строки и сопутствующего языка сценариев.

Предусмотрены следующие расширения для файлов PowerShell:

.ps1 - файлы скриптов,

.psd1 - файлы данных скриптов,

.psm1 - файлы модулей скриптов,

.ps1xml - файлы конфигурации.

С ОС поставляется интегрированная среда сценариев Windows Powershell ISE – облегченная IDE для PowerShell. Для разработки подходит MS Visual Studio Code.

Но скрипты, конечно, можно писать в текстовом редакторе.

**Порядок выполнения работы:**

Использование средств управления будет осуществляться на примере процессов создания локальных пользователей и групп, а также настройки сетевых интерфейсов.

**Часть 1. Консоль MMC.**

1. Запустите Windows Server, авторизуйтесь с правами администратора.
2. С помощью утилиты mmc.exe создайте свою консоль, включающую в себя консоли:

- Управление компьютером,
- Управление службами,
- Просмотр журнала событий,
- Управление общими папками

3. Добавьте в консоль Папку (назовите ее Tools), а в нее кнопку Задачи запуска окна Сетевые подключения.
4. Сохраните оснастку.
5. Создайте с помощью вашей консоли пользователя с именем UPart1_FIO_ и группу GPart1FIO (где FIO - ваши инициалы),
6. Включите пользователя в группу.
7. Сохраните вашу консоль в папку C:\Console\
8. Зайдите в систему под новым пользователем.
9. Запустите вашу консоль, попробуйте перезапустить с ее помощью службу DNS-клиент.
10. С помощью команды runas или с помощью GUI запустите оснастку от имени Администратора. Попробуйте перезапустить с ее помощью службу DNS-клиент.
11. Настройте IP-адреса на сетевом интерфейсе по следующим параметрам:

- **IP 192.168.1.10**
- **mask 255.255.255.0**
- **gateway 192.168.1.1**
- **DNS 8.8.8.8**

**Часть 2. Утилиты командной строки CMD**

1. Запустите Windows Server, авторизуйтесь с правами администратора
2. Создайте скрипт script21.cmd c использованием консольной утилиты net. Скрипт выполняет следующие действия:

- Запрашивает у пользователя Строку (без пробелов, 4 символа),
- Создает пользователя с именем UPart2STR и группу GPart2STR (где STR полученная строка),
- Включает пользователя в группу,
- Активирует пользователя.

1. С помощью консольной утилиты netsh создайте скрипт script22.cmd, который:

- Запрашивает у пользователя параметр Auto или Manual;
- Если пользователь выбирает Auto, то настраивает получение IP адреса, маски, шлюза и DNS автоматически;
- Если выбран Manual, то устанавливает параметры из п. 11 часть 1:

1. Добавьте скрипты в папку Tools вашей консоли.

**Часть 3. Использование**  **PowerShell**

1. Запустите Windows Server, авторизуйтесь с правами администратора
2. Создайте PowerShell-скрипт script31.ps1. Скрипт выполняет следующие действия:

- Запрашивает у пользователя Строку (без пробелов, 4 символа)
- Создает пользователя с именем UPart3STR и группу GPart3STR (где STR полученная строка),
- Включает пользователя в группу,
- Активирует пользователя.

1. Создайте PowerShell-скрипт script32.ps1, который:

- Запрашивает у пользователя параметр Auto или Manual
- Если пользователь выбирает Auto, то настраивает получение IP-адреса, маски, шлюза и DNS автоматически.
- Если выбран Manual, то устанавливает параметры из п. 11 часть 1:

1. Добавьте скрипты в папку Tools вашей консоли.
2. Сохраните копию консоли, так, чтобы ее было невозможно изменить пользователю.

**Содержание отчета**

Требуется подготовить отчеты в формате DOC\DOCX или PDF. Отчет содержит титульный лист, артефакты выполнения и ответы на вопросы.

Артефакты:

1. Скриншот финальной версии консоли
2. Тексты скриптов из части 2 и части 3.

Вопросы:

1. В каких группах оказался пользователь после п.6 Части 1?
2. Сравните организацию диалога в скриптах CMD и PowerShell. Приведите результаты сравнения.
3. Как используя вашу оснастку, управлять службами и пользователями на удаленном компьютере Windows?

Отчет выслать в течение 4-х недель на адрес [edu-net@yandex.ru](mailto:edu-net@yandex.ru).

В теме письма: №группы ФИО (латинскими буквами) №работы (например: 5555 Fedor Sumkin 1)
